{"version":3,"sources":["../src/interaction.js"],"names":["request","require","cheerio","onText","msg","match","user","getSender","ExistInDB","saveToDB","greeting","sendTextMessage","last_message_id","message_id","status","vk_acc_addition","query","search","link","exec","required","createVkPhotoLikeTask","err","console","log","stack","sendMenu","key","SendToAll","userDestination","fromDB","Number","SendTo","PayTo","checkAllTasks","on","data","balance","sendStats","sendAccsEditionMenu","sendEarnMenu","sendTasksMenu","sendVkCreationTaskMenu","vk_acc","uname","sendConfitmVkAccMenu","delVkAcc","task","GetTaskForUser","sendEarnVkPhotoLikeTaskMenu","taskname_query","taskname","confirmTask","text","cost","sendNextTaskMenu","type","answerCallbackQuery","id","messageText","test","addVkAcc"],"mappings":"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","file":"interaction.js","sourcesContent":["let request = require('request');\r\nlet cheerio = require('cheerio');\r\nimport nMenu from './nmenu';\r\nimport bot from './TeleBot';\r\nimport User from './user';\r\nimport Task from './task';\r\nimport Admin from './admin';\r\nimport { WSAEUSERS } from 'constants';\r\n\r\n\r\nbot.onText(/\\/start/, async function (msg, match) {\r\n\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB){\r\n        await user.saveToDB();\r\n        var greeting = \"Привет! Этот бот поможет тебе накрутить лайки в соц.сетях, или заработать, просто лайкая других \";\r\n        await nMenu.sendTextMessage(user, greeting);\r\n        //nMenu.sendMenu(user);\r\n    }\r\n    else{\r\n        const greeting = \"С тобой мы уже знакомы\";\r\n        await nMenu.sendTextMessage(user, greeting);\r\n        //nMenu.sendMenu(user);\r\n    }\r\n});\r\n\r\nbot.onText(/(.*)/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    //bot.sendMessage(msg.from.id, match[1] );\r\n    try{\r\n        \r\n        if(!user.ExistInDB)\r\n            await user.saveToDB();\r\n        user.last_message_id = msg.message_id;\r\n        switch (user.status){\r\n            case 'vk_acc_addition':\r\n                await vk_acc_addition(user, match[1]);\r\n                break;\r\n            case 'create_vk_photo_like_task(link)':\r\n                user.status = 'create_vk_photo_like_task(required){' + match[1] + '})';\r\n                await nMenu.sendTextMessage(user, \"Сколько лайков хочешь получить?\");\r\n                break;\r\n            default:\r\n                const query = /create_vk_photo_like_task\\(required\\)\\{(.*)\\}/g;\r\n                if(user.status.search(query) >= 0){\r\n                    const link = query.exec(user.status)[1];\r\n                    const required = ((/(\\d*)/g).exec(match))[1];\r\n                    await user.createVkPhotoLikeTask(link,match[1]);\r\n                    await nMenu.sendTextMessage(user, \"Молодец, задание создано успешно!\");\r\n                    //nMenu.sendMenu(user);\r\n\r\n                    break;\r\n                }\r\n                user.status = 'free';\r\n            }\r\n    }\r\n    catch(err){\r\n        console.log(err.stack);\r\n        user.status = 'free';\r\n        await nMenu.sendTextMessage(user, err);\r\n        //nMenu.sendMenu(user);\r\n    }\r\n\r\n});\r\n\r\nbot.onText(/\\/menu/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    user.last_message_id = msg.message_id;\r\n    nMenu.sendMenu(user);\r\n});\r\n\r\nbot.onText(/\\/sendtoall (.*)/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    try{\r\n        if(user.key == 'Slava_Ukraini!'){\r\n            await Admin.SendToAll(match[1]);\r\n            nMenu.sendTextMessage(user, 'Success');\r\n        }\r\n    }\r\n    catch(err){\r\n        console.log('err');\r\n        console.log(err.stack);\r\n        nMenu.sendTextMessage(user, 'Error');\r\n    }\r\n    user.last_message_id = msg.message_id;\r\n});\r\n\r\nbot.onText(/\\/sendto (\\d+) (.*)/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    try{\r\n        if(user.key == 'Slava_Ukraini!'){\r\n            let userDestination = await User.fromDB(Number(match[1]));\r\n            await Admin.SendTo(userDestination, match[2]);\r\n            nMenu.sendTextMessage(user, 'Success');\r\n        }\r\n    }\r\n    catch(err){\r\n        console.log('err');\r\n        console.log(err.stack);\r\n        nMenu.sendTextMessage(user, 'Error');\r\n    }\r\n    user.last_message_id = msg.message_id;\r\n});\r\n\r\nbot.onText(/\\/payto (\\d+) (\\d+)/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    try{\r\n        if(user.key == 'Slava_Ukraini!'){\r\n            let userDestination = await User.fromDB(Number(match[1]));\r\n            await Admin.PayTo(userDestination, match[2]);\r\n            nMenu.sendTextMessage(user, 'Success');\r\n        }\r\n    }\r\n    catch(err){\r\n        console.log('err');\r\n        console.log(err.stack);\r\n        nMenu.sendTextMessage(user, 'Error');\r\n    }\r\n    user.last_message_id = msg.message_id;\r\n});\r\n\r\nbot.onText(/\\/paytome (\\d+)/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    try{\r\n        if(user.key == 'Slava_Ukraini!'){\r\n            await Admin.PayTo(user, match[1]);\r\n            nMenu.sendTextMessage(user, 'Success');\r\n        }\r\n    }\r\n    catch(err){\r\n        console.log('err');\r\n        console.log(err.stack);\r\n        nMenu.sendTextMessage(user, 'Error');\r\n    }\r\n    user.last_message_id = msg.message_id;\r\n});\r\n\r\nbot.onText(/\\/checkalltasks/, async function (msg, match) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    try{\r\n        if(user.key == 'Slava_Ukraini!'){\r\n            Admin.checkAllTasks();\r\n        }\r\n    }\r\n    catch(err){\r\n        console.log('err');\r\n        console.log(err.stack);\r\n        nMenu.sendTextMessage(user, 'Error');\r\n    }\r\n    user.last_message_id = msg.message_id;\r\n    nMenu.sendMenu(user);\r\n});\r\n\r\nbot.on('callback_query', async function (msg) {\r\n    let user = await User.getSender(msg);\r\n    if(!user.ExistInDB)\r\n        await user.saveToDB();\r\n    try{\r\n        console.log(msg.data);\r\n        switch (msg.data){\r\n            case '/replenishMoney':\r\n                throw \"Автоматизированная данная функция появится в течение недели. Сейчас для пополнения можете обратиться напрямую в \\\"Помощь\\\"\";\r\n                user.status = 'free';\r\n            case '/withdrawMoney':\r\n                throw \"Вывод меньше 10р запрещен, у тебя \" + user.balance + \". Извини, товарищ... Комиссии.. Потрудись еще немного и возвращайся!\";\r\n                user.status = 'free';\r\n            case '/stats':\r\n                nMenu.sendStats(user);\r\n                user.status = 'free';\r\n                break;\r\n            case '/profiles':\r\n                nMenu.sendAccsEditionMenu(user);\r\n                user.status = 'free';\r\n                break;\r\n            case '/earn':\r\n                nMenu.sendEarnMenu(user);\r\n                user.status = 'free';\r\n                break;\r\n            case '/tasks':\r\n                nMenu.sendTasksMenu(user);\r\n                user.status = 'free';\r\n                break;\r\n            case '/createTask':\r\n                nMenu.sendVkCreationTaskMenu(user);\r\n                user.status = 'free';\r\n                break;\r\n            case '/create_vk_photo_like_task':\r\n                if(user.vk_acc.uname){\r\n                    await nMenu.sendTextMessage(user, 'Пожалуйста, дай нам ссылку на фотографию');\r\n                    user.status = 'create_vk_photo_like_task(link)';\r\n                }\r\n                else{\r\n                    await nMenu.sendTextMessage(user, 'Привяжи ВК аккаунт, чтобы выполнять такие задания');\r\n                    //nMenu.sendMenu(user);\r\n                }\r\n                break;\r\n            case '/addVkAcc':\r\n                user.status = 'vk_acc_addition';\r\n                nMenu.sendConfitmVkAccMenu(user);\r\n                break;\r\n            case '/delVkAcc':\r\n                await user.delVkAcc();\r\n                await nMenu.sendTextMessage(user,\"Аккаунт благополучно отвязан\");\r\n                user.status = 'free';\r\n                //nMenu.sendMenu(user);\r\n                break;\r\n            case '/menu':\r\n                nMenu.sendMenu(user);\r\n                user.status = 'free';\r\n                break;\r\n            case '/earn_vk_photo_like_task':\r\n                let task = await Task.GetTaskForUser(user, 'vk_photo_like_task');\r\n                console.log(task);\r\n                nMenu.sendEarnVkPhotoLikeTaskMenu(user, task);\r\n                user.status = 'free';\r\n                break;\r\n            case '/earn_vk_subscribers_task':\r\n            case '/earn_tg_post_view_task':\r\n            case '/earn_tg_subscribers_task':\r\n                throw('Извини, таких заданий сейчас нет');\r\n                break;\r\n            default:\r\n                \r\n                const taskname_query = /\\/confirm\\((.*)\\)/g;\r\n\r\n\r\n                if(msg.data.search(taskname_query) >= 0 ){\r\n                    let taskname = taskname_query.exec(msg.data)[1];\r\n                    let task = await user.confirmTask(taskname);\r\n                    const text = \"Ты получил \" + task.cost + \" руб. Спасибо за помощь!\";\r\n\r\n                    user.status = 'free';\r\n                    nMenu.sendNextTaskMenu(user, task.type , text);\r\n                }\r\n                break;\r\n                user.status = 'free';\r\n        }\r\n    }\r\n    catch(err){\r\n        console.log(err.stack);///////////////////////////НЕИЗВЕСТНАЯ ОШИБКА\r\n        await nMenu.sendTextMessage(user, err);\r\n        //nMenu.sendMenu(user);\r\n    }\r\n    bot.answerCallbackQuery(msg.id, \"\", true);\r\n});\r\n\r\nasync function vk_acc_addition(user, link){\r\n    let messageText;\r\n    if(/vk.com\\//.test(link)){\r\n        await user.addVkAcc(link);\r\n        messageText = 'Аккаунт успешно привязан!';\r\n    }\r\n    else \r\n    messageText = \"Неправильная ссылка. Должно быть что-то типа \\'vk.com/id123456789\\'\";\r\n\r\n    user.status = 'free';\r\n    await nMenu.sendTextMessage(user, messageText);\r\n    //nMenu.sendAccsEditionMenu(user);\r\n}\r\n\r\n\r\n"]}